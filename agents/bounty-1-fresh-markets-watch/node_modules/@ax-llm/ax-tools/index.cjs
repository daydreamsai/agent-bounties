"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { newObj[key] = obj[key]; } } } newObj.default = obj; return newObj; } } function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } var _class;var _child_process = require('child_process');var _readline = require('readline'); var _readline2 = _interopRequireDefault(_readline);var s= (_class =class{__init() {this.pendingResponses=new Map}constructor(e){;_class.prototype.__init.call(this);this.process=_child_process.spawn.call(void 0, e.command,_nullishCoalesce(e.args, () => ([])),{env:e.env?{...process.env,...e.env}:process.env}),this.rl=_readline2.default.createInterface({input:this.process.stdout}),this.rl.on("line",r=>{try{let t=JSON.parse(r),p=this.pendingResponses.get(t.id);p&&(p(t),this.pendingResponses.delete(t.id))}catch (e2){console.warn("Non-JSON output from MCP server:",r)}})}async send(e){return new Promise(r=>{this.pendingResponses.set(e.id,t=>{r(t)}),this.process.stdin.write(`${JSON.stringify(e)}
`)})}async sendNotification(e){this.process.stdin.write(`${JSON.stringify(e)}
`)}async connect(){return Promise.resolve()}async terminate(){return this.rl.close(),this.process.kill(),new Promise(e=>{this.process.on("exit",()=>e())})}}, _class);function a(o){return new s(o)}var _fs = require('fs'); var u = _interopRequireWildcard(_fs);var _http = require('http'); var l = _interopRequireWildcard(_http);var _https = require('https'); var C = _interopRequireWildcard(_https);var _os = require('os'); var P = _interopRequireWildcard(_os);var _process = require('process'); var x = _interopRequireWildcard(_process);var _vm = require('vm');function S(){if(globalThis.crypto&&typeof globalThis.crypto.randomUUID=="function")return globalThis.crypto;throw new Error("Web Crypto API with randomUUID support not available. Requires Node.js 16+ or modern browser.")}var c=(n=>(n.FS="node:fs",n.NET="net",n.OS="os",n.CRYPTO="crypto",n.PROCESS="process",n))(c||{}),i= exports.AxJSInterpreter =class{constructor({permissions:e=[]}={}){this.permissions=_nullishCoalesce(e, () => ([]))}codeInterpreterJavascript(e){let r={console};return this.permissions.includes("node:fs")&&(r.fs=u),this.permissions.includes("net")&&(r.http=l,r.https=C),this.permissions.includes("os")&&(r.os=P),this.permissions.includes("crypto")&&(r.crypto=S()),this.permissions.includes("process")&&(r.process=x),_vm.runInNewContext.call(void 0, `(function() { ${e} })()`,r)}toFunction(){return{name:"javascriptInterpreter",description:"Use this function to run Javascript code and get any expected return value",parameters:{type:"object",properties:{code:{type:"string",description:"JS code with a return value in the end."}},required:["code"]},func:({code:e})=>this.codeInterpreterJavascript(e)}}};function h(o){return new i(o)}exports.AxJSInterpreter = i; exports.AxJSInterpreterPermission = c; exports.AxMCPStdioTransport = s; exports.axCreateJSInterpreter = h; exports.axCreateMCPStdioTransport = a;
//# sourceMappingURL=index.cjs.map